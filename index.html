<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrenador de Cables: Paso a Paso</title>
    <style>
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: #f0f2f5; color: #333; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { background: white; width: 100%; max-width: 700px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); padding: 30px; }
        h1 { text-align: center; color: #003366; margin-bottom: 25px; }
        
        /* MEN√ö PRINCIPAL */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .menu-btn {
            padding: 25px; border: 2px solid #003366; background: #f8faff; border-radius: 10px; cursor: pointer; text-align: center; transition: 0.2s;
        }
        .menu-btn:hover { background: #e6efff; transform: translateY(-3px); }
        .menu-btn h3 { margin: 0 0 10px 0; color: #003366; }
        .menu-btn p { margin: 0; color: #666; font-size: 0.9em; }

        /* √ÅREA DE EJERCICIO */
        #exercise-area { display: none; }
        .step-box { background: #e3f2fd; padding: 20px; border-left: 5px solid #2196f3; margin-bottom: 20px; border-radius: 4px; }
        .step-title { font-weight: bold; color: #0d47a1; margin-bottom: 10px; display: block; }
        .data-big { font-size: 1.5em; font-weight: bold;text-align: center; margin: 15px 0; color: #000; }
        .highlight { color: #d32f2f; font-weight: bold; }

        /* BOTONES DE RESPUESTA */
        .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-top: 25px; }
        .opt-btn {
            padding: 15px; font-size: 1.2em; font-weight: bold; border: 2px solid #ccc; background: white; border-radius: 8px; cursor: pointer;
        }
        .opt-btn:hover { border-color: #003366; background: #f9f9f9; }
        .correct { background: #d4edda !important; border-color: #28a745 !important; color: #155724; }
        .wrong { background: #f8d7da !important; border-color: #dc3545 !important; color: #721c24; }

        .feedback { margin-top: 20px; padding: 15px; border-radius: 8px; font-size: 1.1em; display: none; }
        
        .back-btn { background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-bottom: 20px; }
        #next-btn { width: 100%; padding: 15px; background: #003366; color: white; border: none; border-radius: 8px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 20px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>Entrenador de Cables: Paso a Paso</h1>

    <div id="main-menu">
        <p style="text-align:center; margin-bottom:20px;">¬øQu√© m√©todo quieres practicar ahora?</p>
        <div class="menu-grid">
            <div class="menu-btn" onclick="startMode('density')">
                <h3>M√©todo 1: R√°pido</h3>
                <p>(Usando Densidad 4 A/mm¬≤)</p>
                <div style="margin-top:10px; font-family:monospace; font-weight:bold;">S = I / 4</div>
            </div>
            <div class="menu-btn" onclick="startMode('long')">
                <h3>M√©todo 2: F√≥rmula Larga</h3>
                <p>(Usando el largo y voltaje)</p>
                <div style="margin-top:10px; font-family:monospace; font-weight:bold;">S = (I¬∑L¬∑0.017) / e</div>
            </div>
        </div>
    </div>

    <div id="exercise-area">
        <button class="back-btn" onclick="location.reload()">‚Üê Volver al Men√∫</button>
        
        <div id="question-steps"></div>

        <div style="text-align:center; margin-top:30px; font-weight:bold;">üëá Elige el cable comercial üëá</div>
        <div class="options-grid" id="options-box"></div>
        
        <div class="feedback" id="feedback-msg"></div>
        <button id="next-btn" onclick="nextQuestion()">Siguiente Ejercicio ‚û°</button>
    </div>

</div>

<script>
    let currentMode = '';
    let currentQ = {};

    // --- INICIO ---
    function startMode(mode) {
        currentMode = mode;
        document.getElementById('main-menu').style.display = 'none';
        document.getElementById('exercise-area').style.display = 'block';
        nextQuestion();
    }

    // --- GENERADOR DE PREGUNTAS ---
    function nextQuestion() {
        resetUI();
        if (currentMode === 'density') {
            setupDensityQ();
        } else {
            setupLongQ();
        }
    }

    function setupDensityQ() {
        // 1. Datos
        const I = (Math.floor(Math.random() * 6) + 1) * 5; // 5, 10, 15, 20, 25, 30 A
        const D = 4;
        const exact = I / D;
        const commercial = getCommercial(exact);

        // 2. Mostrar Pasos
        const stepsHTML = `
            <div class="step-box">
                <span class="step-title">PASO 1: Los Datos</span>
                Tienes un consumo de <b style="font-size:1.2em">${I} Amperes</b>.
                <br>Tu profesor dice que la densidad m√°xima es <b>4 A/mm¬≤</b>.
            </div>
            <div class="step-box" style="background:#fff3e0; border-color:#ff9800;">
                <span class="step-title" style="color:#e65100;">PASO 2: El C√°lculo Mental</span>
                Divide los Amperes por la Densidad:
                <div class="data-big">${I} √∑ 4 = ${exact.toFixed(2)} mm¬≤</div>
                Este es el grosor <b>exacto</b> que necesitas.
            </div>
            <div class="step-box" style="background:#e8f5e9; border-color:#4caf50;">
                <span class="step-title" style="color:#2e7d32;">PASO 3: Elegir el Cable Real</span>
                Como no venden cable de ${exact.toFixed(2)}, debes comprar el que viene <b>inmediatamente despu√©s</b> en la tienda.
            </div>
        `;
        document.getElementById('question-steps').innerHTML = stepsHTML;

        // 3. Opciones
        currentQ = { correct: commercial, exact: exact.toFixed(2) };
        renderOptions(commercial);
    }

    function setupLongQ() {
        // 1. Datos
        const is24V = Math.random() > 0.5;
        const voltage = is24V ? 24 : 12;
        const drop = is24V ? 0.72 : 0.36;
        const L = Math.floor(Math.random() * 6) + 3; // 3 a 8 metros
        const I = (Math.floor(Math.random() * 4) + 1) * 5; // 5 a 20 A

        // C√°lculo
        const numerator = I * L * 0.017;
        const exact = numerator / drop;
        const commercial = getCommercial(exact);

        // 2. Mostrar Pasos CLAROS
        const stepsHTML = `
            <div class="step-box">
                <span class="step-title">PASO 1: Los Datos del Veh√≠culo</span>
                Sistema: <b>${voltage}V</b> (Maquinaria/Auto)<br>
                Corriente: <b>${I} Amperes</b><br>
                Largo del cable: <b>${L} metros</b>
            </div>
            <div class="step-box" style="background:#fff3e0; border-color:#ff9800;">
                <span class="step-title" style="color:#e65100;">PASO 2: Definir la Ca√≠da de Voltaje (e)</span>
                Como el sistema es de <b>${voltage}V</b>, usaremos:
                <div class="data-big">e = ${drop} Volts</div>
            </div>
             <div class="step-box" style="background:#eceff1; border-color:#607d8b;">
                <span class="step-title" style="color:#37474f;">PASO 3: La F√≥rmula de tu Cuaderno</span>
                <small>S = (I √ó L √ó 0.017) / e</small><br>
                <br>
                Primero, multiplica lo de arriba: ${I} √ó ${L} √ó 0.017 = <b>${numerator.toFixed(3)}</b>
                <br>
                Ahora, divide por la ca√≠da (e):
                <div class="data-big">${numerator.toFixed(3)} √∑ ${drop} = ${exact.toFixed(2)} mm¬≤</div>
            </div>
        `;
        document.getElementById('question-steps').innerHTML = stepsHTML;

        // 3. Opciones
        currentQ = { correct: commercial, exact: exact.toFixed(2) };
        renderOptions(commercial);
    }

    // --- UTILIDADES ---
    function getCommercial(val) {
        const cables = [0.75, 1.0, 1.5, 2.5, 4.0, 6.0, 10.0];
        for (let c of cables) {
            if (c >= val) return c;
        }
        return 16.0;
    }

    function renderOptions(correctVal) {
        const box = document.getElementById('options-box');
        box.innerHTML = '';
        
        // Siempre mostrar un set est√°ndar de opciones para que se familiarice
        const standardOpts = [1.0, 1.5, 2.5, 4.0, 6.0];
        // Asegurar que la correcta est√©, si es muy chica o muy grande
        if(!standardOpts.includes(correctVal) && correctVal < 10) {
             standardOpts.push(correctVal);
             standardOpts.sort((a,b) => a-b);
        }
        
        standardOpts.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = `${opt} mm¬≤`;
            btn.onclick = () => checkAnswer(btn, opt);
            box.appendChild(btn);
        });
    }

    function checkAnswer(btn, value) {
        const allBtns = document.querySelectorAll('.opt-btn');
        allBtns.forEach(b => b.disabled = true);
        
        const fb = document.getElementById('feedback-msg');
        fb.style.display = 'block';

        if (value === currentQ.correct) {
            btn.classList.add('correct');
            fb.style.background = "#d4edda"; fb.style.color = "#155724";
            fb.innerHTML = `‚úÖ <b>¬°Correcto!</b><br>El c√°lculo dio exacto <b>${currentQ.exact} mm¬≤</b>. Muy bien elegido el comercial superior de ${currentQ.correct} mm¬≤.`;
        } else {
            btn.classList.add('wrong');
             // Marcar la correcta
            allBtns.forEach(b => {
                if(parseFloat(b.innerText) === currentQ.correct) b.classList.add('correct');
            });
            fb.style.background = "#f8d7da"; fb.style.color = "#721c24";
            fb.innerHTML = `‚ùå <b>Incorrecto.</b><br>El c√°lculo exacto era <b>${currentQ.exact} mm¬≤</b>.<br>No puedes usar un cable m√°s chico. Debiste elegir <b>${currentQ.correct} mm¬≤</b>.`;
        }
        document.getElementById('next-btn').style.display = 'block';
    }

    function resetUI() {
        document.getElementById('feedback-msg').style.display = 'none';
        document.getElementById('next-btn').style.display = 'none';
        document.getElementById('options-box').innerHTML = '';
    }
</script>

</body>
</html>
