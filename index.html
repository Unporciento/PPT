<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrenador de Cables - F√≥rmula INACAP</title>
    <style>
        body { font-family: 'Arial', sans-serif; background: #2c3e50; color: white; text-align: center; padding: 20px; }
        .container { background: #34495e; max-width: 600px; margin: 0 auto; padding: 30px; border-radius: 10px; box-shadow: 0 10px 20px rgba(0,0,0,0.3); border: 2px solid #f1c40f; }
        
        .formula-box { background: #222; padding: 10px; border-radius: 5px; font-family: monospace; color: #f1c40f; margin-bottom: 20px; border: 1px dashed #7f8c8d; }
        
        h1 { color: #f1c40f; text-transform: uppercase; margin-top: 0; }
        .question { font-size: 1.3em; margin: 20px 0; font-weight: bold; min-height: 80px; display: flex; align-items: center; justify-content: center; }
        
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        button { padding: 15px; font-size: 1.1em; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; transition: 0.2s; }
        .btn-opt { background: #ecf0f1; color: #2c3e50; }
        .btn-opt:hover { background: #bdc3c7; }
        
        .correct { background: #27ae60 !important; color: white !important; }
        .wrong { background: #c0392b !important; color: white !important; }
        
        #feedback { margin-top: 20px; font-size: 1em; display: none; background: #222; padding: 15px; border-radius: 5px; }
        #next-btn { background: #f39c12; color: white; width: 100%; margin-top: 15px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>üìê Calculadora de Cables</h1>
    
    <div class="formula-box" id="formula-display">
        F√≥rmula: S = (I √ó 0.017 √ó L) / V_caida
    </div>

    <div class="question" id="q-text">
        Cargando ejercicio...
    </div>

    <div class="btn-grid" id="options-area">
        </div>

    <div id="feedback"></div>
    <button id="next-btn" onclick="generateQuestion()">Siguiente Ejercicio ‚û°</button>
</div>

<script>
    // Variables globales
    let currentQ = {};

    function generateQuestion() {
        // Limpiar
        document.getElementById('feedback').style.display = 'none';
        document.getElementById('next-btn').style.display = 'none';
        const optsArea = document.getElementById('options-area');
        optsArea.innerHTML = '';

        // Decidir tipo de pregunta (50% Densidad, 50% F√≥rmula Larga)
        const type = Math.random() > 0.5 ? 'density' : 'long';

        if (type === 'density') {
            setupDensityQuestion();
        } else {
            setupLongQuestion();
        }
    }

    function setupDensityQuestion() {
        // Generar datos
        const I = (Math.floor(Math.random() * 4) + 1) * 5; // 5, 10, 15, 20 Amperes
        const D = 4; // Densidad fija t√≠pica (4 A/mm2)
        
        const calc = I / D; 
        // Cables comerciales: 0.75, 1, 1.5, 2.5, 4, 6
        const commercial = getCommercial(calc);

        currentQ = {
            text: `üîß <b>C√°lculo R√°pido:</b><br>Tienes un consumo de <b>${I} Amperes</b>.<br>La densidad permitida es <b>4 A/mm¬≤</b>.<br>¬øQu√© cable usas?`,
            correctVal: commercial,
            formula: `S = ${I}A √∑ 4`,
            exact: calc.toFixed(2)
        };
        
        document.getElementById('formula-display').innerText = "F√≥rmula: S = Intensidad / Densidad";
        renderOptions(commercial);
    }

    function setupLongQuestion() {
        // Generar datos
        const voltage = Math.random() > 0.5 ? 12 : 24;
        const drop = voltage === 12 ? 0.36 : 0.72;
        const L = Math.floor(Math.random() * 5) + 2; // 2 a 6 metros
        const I = (Math.floor(Math.random() * 3) + 1) * 5; // 5, 10, 15 Amperes
        
        // F√≥rmula de tu cuaderno: (I * 0.017 * L) / drop
        const exact = (I * 0.017 * L) / drop;
        const commercial = getCommercial(exact);

        currentQ = {
            text: `üöõ <b>Sistema de ${voltage}V:</b><br>Largo: <b>${L} metros</b>.<br>Consumo: <b>${I} Amperes</b>.<br>Calcula la secci√≥n.`,
            correctVal: commercial,
            formula: `S = (${I} √ó 0.017 √ó ${L}) √∑ ${drop}`,
            exact: exact.toFixed(2)
        };

        document.getElementById('formula-display').innerText = `F√≥rmula: S = (I √ó 0.017 √ó L) / ${drop}`;
        renderOptions(commercial);
    }

    function getCommercial(val) {
        // Lista cables: 0.5, 0.75, 1.0, 1.5, 2.5, 4.0, 6.0
        const cables = [0.5, 0.75, 1.0, 1.5, 2.5, 4.0, 6.0];
        for (let c of cables) {
            if (c >= val) return c;
        }
        return 10.0; // Si es muy grande
    }

    function renderOptions(correctAnswer) {
        // Generar distractores
        let opts = new Set();
        opts.add(correctAnswer);
        
        // Cables posibles para distractores
        const cableTypes = [0.75, 1.0, 1.5, 2.5, 4.0, 6.0];
        
        while(opts.size < 4) {
            const randomC = cableTypes[Math.floor(Math.random() * cableTypes.length)];
            if(randomC !== correctAnswer) opts.add(randomC);
        }

        // Convertir a array y mezclar
        const finalOpts = Array.from(opts).sort((a, b) => a - b);

        const container = document.getElementById('options-area');
        document.getElementById('q-text').innerHTML = currentQ.text;

        finalOpts.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'btn-opt';
            btn.innerHTML = `${opt} mm¬≤`;
            btn.onclick = () => check(btn, opt);
            container.appendChild(btn);
        });
    }

    function check(btn, value) {
        const allBtns = document.querySelectorAll('.btn-opt');
        allBtns.forEach(b => b.disabled = true);

        const fb = document.getElementById('feedback');
        fb.style.display = 'block';

        if (value === currentQ.correctVal) {
            btn.classList.add('correct');
            fb.innerHTML = `‚úÖ <b>¬°Correcto!</b><br>C√°lculo exacto: ${currentQ.exact} mm¬≤.<br>Usamos el comercial superior: <b>${currentQ.correctVal} mm¬≤</b>.<br><small>${currentQ.formula}</small>`;
        } else {
            btn.classList.add('wrong');
            // Buscar y marcar el correcto
            allBtns.forEach(b => {
                if(b.innerHTML.includes(currentQ.correctVal)) b.classList.add('correct');
            });
            fb.innerHTML = `‚ùå <b>Incorrecto.</b><br>El c√°lculo daba: ${currentQ.exact} mm¬≤.<br>Debiste elegir <b>${currentQ.correctVal} mm¬≤</b>.<br><small>${currentQ.formula}</small>`;
        }
        
        document.getElementById('next-btn').style.display = 'block';
    }

    // Iniciar
    generateQuestion();

</script>

</body>
</html>
